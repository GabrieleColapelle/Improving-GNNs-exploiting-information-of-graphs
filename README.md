### EXPLOITING STRUCTURAL INFORMATION FOR IMPROVING HETEROGENEOUS GRAPH NEURAL NETWORKS

 This GitHub repository contains the code for the implementation and evaluation of the Heterogeneous Graph Transformer (HGT) architecture proposed in the master thesis titled "Improving Heterogeneous Graph Transformer Architecture for Processing Heterogeneous Graphs".
 
#### Install Pytorch and DGL to process graph and build Neural Network

```
 $ pip3 install torch torchvision torchaudio
 $ pip3 install dgl -f https://data.dgl.ai/wheels/repo.html 
 ```
 
 #### Install MlFlow and Optuna to track and optimize experiments

```
$ pip3 install mlflow
$ pip3 install optuna
```
#### Install Networkx and CDlib for network analysis tasks
```
$ pip3 install networkx
$ pip3 install cdlib
```

## Datasets

Preprocessed ACM can be found in: https://pan.baidu.com/s/1V2iOikRqHPtVvaANdkzROw  key：50k2 or https://github.com/Jhy1993/HAN/tree/master/data/acm

Preprocessed DBLP can be found in: https://pan.baidu.com/s/1Qr2e97MofXsBhUvQqgJqDg  key：6b3h or https://github.com/Jhy1993/HAN/tree/master/data/DBLP_four_area


Preprocessed IMDB can be found in: https://pan.baidu.com/s/199LoAr5WmL3wgx66j-qwaw  key: qkec
 or https://raw.githubusercontent.com/Jhy1993/HAN/master/data/imdb/movie_metadata.csv
 

## Overview
The most important files in this projects are as follow:

* Model
  * model_base.iypnb
  * model_com_embedding.ipynb
* Data
* Experiments
* Features Engineering
* FastRP
         


conv.py: The core of our model, implements the transformer-like heterogeneous graph convolutional layer.
model.py: The wrap of different model components.
data.py: The data interface and usage.
class Graph: The data structure of heterogeneous graph. Stores feature in Graph.node_feature as pandas.DataFrame; Stores adjacency matrix in Graph.edge_list as dictionay.
def sample_subgraph: The sampling algorithm for heterogeneous graph. Each iteration samples a fixed number of nodes per type. All the sampled nodes are within the region of already sampled nodes, with sampling probability as the square of relative degree.
train_*.py: The training and validation script for a specific downstream task.
def *_sample: The sampling function for a given task. Remember to mask out existing link within the graph to avoid information leakage.
def prepare_data: Conduct sampling in parallel with multiple processes, which can seamlessly coordinate with model training.
 
 
 
## Results

<img width="350" alt="image" src="https://user-images.githubusercontent.com/48983745/222445864-6b2131af-2a4a-4bc3-bb30-ca0e83542ee5.png">

